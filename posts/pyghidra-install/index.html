<!DOCTYPE html>
<html lang="zh"><head>
<title>Python 调用 Ghidra 实现反汇编</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="G-XXXXXXXXXX">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5, user-scalable=5" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:url" content="http://example.org/posts/pyghidra-install/">
  <meta property="og:site_name" content="cvolcanob&#39; blog">
  <meta property="og:title" content="Python 调用 Ghidra 实现反汇编">
  <meta property="og:description" content="在逆向工程、二进制安全分析与漏洞挖掘领域，反汇编是拆解二进制程序、还原其底层执行逻辑的核心技术手段。Ghidra是由 美国国家安全局（NSA） 开源的跨平台、全功能逆向工程套件，也是当前逆向分析、二进制反汇编领域最主流、最强大的工具之一，完全免费且开源可定制。它的核心能力覆盖二进制程序全生命周期分析：支持 x86、ARM、MIPS 等几乎所有主流处理器架构的反汇编、反编译（可直接将机器码还原为类 C 伪代码）、程序流程分析、数据结构识别、漏洞定位等核心功能，同时提供可视化的交互界面，兼顾手动逆向分析与脚本化批量处理需求。其唯一的「小短板」在于：原生交互以 GUI 操作为主，高阶批量分析、定制化反汇编逻辑需要依托脚本能力。因此官方先后提供了pyhidra和pyghidra两个包支持。目前pyhidra已经停止更新，下载时可以有效考虑使用pyghidra。
安装 Ghidra 和使用其 Python API 安装 Ghidra Ghidra的安装非常容易，首先需要到ghidra仓库下载，这里我在ubuntu22.04环境下，下载 12.0 版本工具，对应要下载 Java21，根据自己的需要可以下载对应的 Java 即可
sudo apt update sudo apt install -y openjdk-21-jdk openjdk-21-jre 然后把你下载的 Ghidra 压缩包解压到希望的地方
# 解压 unzip ghidra_12.0.0_PUBLIC_20241105.zip # 重命名为简单的目录名（可选） mv ghidra_12.0.0_PUBLIC ghidra 设置环境变量
# 添加Ghidra到PATH echo &#39;export GHIDRA_INSTALL_DIR=~/tools/ghidra&#39; &gt;&gt; ~/.bashrc echo &#39;export PATH=$GHIDRA_INSTALL_DIR:$PATH&#39; &gt;&gt; ~/.bashrc source ~/.bashrc 测试 Ghidra GUI 启动（可选）
cd ~/tools/ghidra ./ghidraRun # 或者如果设置了环境变量 ghidraRun 安装 PyGhidra 然后是PyGhidra，有两种安装方法，第一种是直接使用在线下载安装">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-30T02:19:15+00:00">
    <meta property="article:modified_time" content="2025-12-30T02:19:15+00:00">
    <meta property="article:tag" content="Ghidra">
    <meta property="article:tag" content="Python">






  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Python 调用 Ghidra 实现反汇编">
  <meta name="twitter:description" content="在逆向工程、二进制安全分析与漏洞挖掘领域，反汇编是拆解二进制程序、还原其底层执行逻辑的核心技术手段。Ghidra是由 美国国家安全局（NSA） 开源的跨平台、全功能逆向工程套件，也是当前逆向分析、二进制反汇编领域最主流、最强大的工具之一，完全免费且开源可定制。它的核心能力覆盖二进制程序全生命周期分析：支持 x86、ARM、MIPS 等几乎所有主流处理器架构的反汇编、反编译（可直接将机器码还原为类 C 伪代码）、程序流程分析、数据结构识别、漏洞定位等核心功能，同时提供可视化的交互界面，兼顾手动逆向分析与脚本化批量处理需求。其唯一的「小短板」在于：原生交互以 GUI 操作为主，高阶批量分析、定制化反汇编逻辑需要依托脚本能力。因此官方先后提供了pyhidra和pyghidra两个包支持。目前pyhidra已经停止更新，下载时可以有效考虑使用pyghidra。
安装 Ghidra 和使用其 Python API 安装 Ghidra Ghidra的安装非常容易，首先需要到ghidra仓库下载，这里我在ubuntu22.04环境下，下载 12.0 版本工具，对应要下载 Java21，根据自己的需要可以下载对应的 Java 即可
sudo apt update sudo apt install -y openjdk-21-jdk openjdk-21-jre 然后把你下载的 Ghidra 压缩包解压到希望的地方
# 解压 unzip ghidra_12.0.0_PUBLIC_20241105.zip # 重命名为简单的目录名（可选） mv ghidra_12.0.0_PUBLIC ghidra 设置环境变量
# 添加Ghidra到PATH echo &#39;export GHIDRA_INSTALL_DIR=~/tools/ghidra&#39; &gt;&gt; ~/.bashrc echo &#39;export PATH=$GHIDRA_INSTALL_DIR:$PATH&#39; &gt;&gt; ~/.bashrc source ~/.bashrc 测试 Ghidra GUI 启动（可选）
cd ~/tools/ghidra ./ghidraRun # 或者如果设置了环境变量 ghidraRun 安装 PyGhidra 然后是PyGhidra，有两种安装方法，第一种是直接使用在线下载安装">







      <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
      <script>
        var doNotTrack = false;
        if ( true ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-XXXXXXXXXX');
        }
      </script>




<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "abcdefghzd");
</script>



  






      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css" integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    博文
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    专栏
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    标签
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85-ghidra-%e5%92%8c%e4%bd%bf%e7%94%a8%e5%85%b6-python-api" class="nav-安装-ghidra-和使用其-python-api">
									安装 Ghidra 和使用其 Python API
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85-ghidra" class="nav-安装-ghidra">
									安装 Ghidra
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85-pyghidra" class="nav-安装-pyghidra">
									安装 PyGhidra
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%ae%80%e5%8d%95%e7%9a%84-pyghidra-%e8%b0%83%e7%94%a8%e4%be%8b%e7%a8%8b" class="nav-简单的-pyghidra-调用例程">
									简单的 PyGhidra 调用例程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-%e5%88%9d%e5%a7%8b%e5%8c%96-pyghidra-%e7%8e%af%e5%a2%83" class="nav-1-初始化-pyghidra-环境">
									1. 初始化 PyGhidra 环境
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-%e5%88%9b%e5%bb%ba-ghidra-%e9%a1%b9%e7%9b%ae" class="nav-2-创建-ghidra-项目">
									2. 创建 Ghidra 项目
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-%e5%af%bc%e5%85%a5%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%96%87%e4%bb%b6" class="nav-3-导入二进制文件">
									3. 导入二进制文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4-%e8%8e%b7%e5%8f%96%e7%a8%8b%e5%ba%8f%e5%b9%b6%e6%89%a7%e8%a1%8c%e8%87%aa%e5%8a%a8%e5%88%86%e6%9e%90" class="nav-4-获取程序并执行自动分析">
									4. 获取程序并执行自动分析
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5-%e6%8f%90%e5%8f%96%e7%a8%8b%e5%ba%8f%e6%9e%b6%e6%9e%84%e4%bf%a1%e6%81%af" class="nav-5-提取程序架构信息">
									5. 提取程序架构信息
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6-%e9%81%8d%e5%8e%86%e5%87%bd%e6%95%b0" class="nav-6-遍历函数">
									6. 遍历函数
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#7-%e5%88%86%e6%9e%90%e5%9f%ba%e6%9c%ac%e5%9d%97%e5%92%8c%e6%8e%a7%e5%88%b6%e6%b5%81" class="nav-7-分析基本块和控制流">
									7. 分析基本块和控制流
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#8-%e6%8f%90%e5%8f%96%e6%8c%87%e4%bb%a4" class="nav-8-提取指令">
									8. 提取指令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#9-%e5%88%86%e6%9e%90%e6%8e%a7%e5%88%b6%e6%b5%81%e8%be%b9" class="nav-9-分析控制流边">
									9. 分析控制流边
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="http://example.org/">
            cvolcanob&#39; blog
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="http://example.org/">
        <div class="single-column-header-title">cvolcanob&#39; blog</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    Python 调用 Ghidra 实现反汇编
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2025-12-30 02:19
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/ghidra">Ghidra</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/ghidra">ghidra</a>
                                &nbsp;
                            
                                <a href="/tags/python">python</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>在逆向工程、二进制安全分析与漏洞挖掘领域，反汇编是拆解二进制程序、还原其底层执行逻辑的核心技术手段。Ghidra是由 美国国家安全局（NSA） 开源的跨平台、全功能逆向工程套件，也是当前逆向分析、二进制反汇编领域最主流、最强大的工具之一，完全免费且开源可定制。它的核心能力覆盖二进制程序全生命周期分析：支持 x86、ARM、MIPS 等几乎所有主流处理器架构的反汇编、反编译（可直接将机器码还原为类 C 伪代码）、程序流程分析、数据结构识别、漏洞定位等核心功能，同时提供可视化的交互界面，兼顾手动逆向分析与脚本化批量处理需求。其唯一的「小短板」在于：原生交互以 GUI 操作为主，高阶批量分析、定制化反汇编逻辑需要依托脚本能力。因此官方先后提供了<code>pyhidra</code>和<code>pyghidra</code>两个包支持。目前<code>pyhidra</code>已经停止更新，下载时可以有效考虑使用<code>pyghidra</code>。</p>
<h2 id="安装-ghidra-和使用其-python-api">安装 Ghidra 和使用其 Python API</h2>
<h3 id="安装-ghidra">安装 Ghidra</h3>
<p>Ghidra的安装非常容易，首先需要到<a href="https://github.com/NationalSecurityAgency/ghidra">ghidra</a>仓库下载，这里我在ubuntu22.04环境下，下载 12.0 版本工具，对应要下载 Java21，根据自己的需要可以下载对应的 Java 即可</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install -y openjdk-21-jdk openjdk-21-jre
</span></span></code></pre></div><p>然后把你下载的 Ghidra 压缩包解压到希望的地方</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#228b22"># 解压</span>
</span></span><span style="display:flex;"><span>unzip ghidra_12.0.0_PUBLIC_20241105.zip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 重命名为简单的目录名（可选）</span>
</span></span><span style="display:flex;"><span>mv ghidra_12.0.0_PUBLIC ghidra
</span></span></code></pre></div><p>设置环境变量</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#228b22"># 添加Ghidra到PATH</span>
</span></span><span style="display:flex;"><span><span style="color:#658b00">echo</span> <span style="color:#cd5555">&#39;export GHIDRA_INSTALL_DIR=~/tools/ghidra&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span style="display:flex;"><span><span style="color:#658b00">echo</span> <span style="color:#cd5555">&#39;export PATH=$GHIDRA_INSTALL_DIR:$PATH&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#658b00">source</span> ~/.bashrc
</span></span></code></pre></div><p>测试 Ghidra GUI 启动（可选）</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#658b00">cd</span> ~/tools/ghidra
</span></span><span style="display:flex;"><span>./ghidraRun
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 或者如果设置了环境变量</span>
</span></span><span style="display:flex;"><span>ghidraRun
</span></span></code></pre></div><h3 id="安装-pyghidra">安装 PyGhidra</h3>
<p>然后是<code>PyGhidra</code>，有两种安装方法，第一种是直接使用在线下载安装</p>
<pre tabindex="0"><code>pip install pyghidra
</code></pre><p>如果担心兼容性之类的问题，可以用 git 下载的 Ghidra 仓库中的 pypkg</p>
<pre tabindex="0"><code>python3 -m pip install --no-index -f &lt;GhidraInstallDir&gt;/Ghidra/Features/PyGhidra/pypkg/dist pyghidra
</code></pre><h2 id="简单的-pyghidra-调用例程">简单的 PyGhidra 调用例程</h2>
<h3 id="1-初始化-pyghidra-环境">1. 初始化 PyGhidra 环境</h3>
<p>第一步是启动 PyGhidra 的 JVM 环境。PyGhidra 会自动定位 Ghidra 安装目录,或者你可以手动指定:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22"># 检查 pyghidra 是否已启动</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#8b008b">not</span> pyghidra.started():
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Starting pyghidra with install_dir=</span><span style="color:#cd5555">{</span>ghidra_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>    pyghidra.start(install_dir=ghidra_path)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;pyghidra already started&#34;</span>)
</span></span></code></pre></div><p><strong>关键点</strong>:</p>
<ul>
<li><code>pyghidra.started()</code>: 检查 JVM 是否已经启动,避免重复初始化</li>
<li><code>pyghidra.start()</code>: 启动 Ghidra 的 JVM 环境,可选参数 <code>install_dir</code> 指定 Ghidra 安装路径</li>
<li>如果没有设置 <code>install_dir</code>,PyGhidra 会自动查找 <code>GHIDRA_INSTALL_DIR</code> 环境变量</li>
</ul>
<h3 id="2-创建-ghidra-项目">2. 创建 Ghidra 项目</h3>
<p>Ghidra 使用项目(Project)来组织分析结果。我们创建一个临时项目用于演示:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">tempfile</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 创建临时项目目录</span>
</span></span><span style="display:flex;"><span>project_dir = tempfile.mkdtemp(prefix=<span style="color:#cd5555">&#39;ghidra_demo_&#39;</span>)
</span></span><span style="display:flex;"><span>project_name = <span style="color:#cd5555">&#39;demo_project&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Creating project at: </span><span style="color:#cd5555">{</span>project_dir<span style="color:#cd5555">}</span><span style="color:#cd5555">/</span><span style="color:#cd5555">{</span>project_name<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 打开或创建项目</span>
</span></span><span style="display:flex;"><span>project = pyghidra.open_project(project_dir, project_name, create=<span style="color:#8b008b;font-weight:bold">True</span>)
</span></span></code></pre></div><h3 id="3-导入二进制文件">3. 导入二进制文件</h3>
<p>将二进制文件导入到 Ghidra 项目中:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22"># 获取二进制文件名</span>
</span></span><span style="display:flex;"><span>program_name = os.path.basename(binary_path)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Importing binary: </span><span style="color:#cd5555">{</span>binary_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 创建加载器并配置</span>
</span></span><span style="display:flex;"><span>loader = pyghidra.program_loader()
</span></span><span style="display:flex;"><span>loader = loader.project(project).source(binary_path).name(program_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 加载二进制文件</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">with</span> loader.load() <span style="color:#8b008b;font-weight:bold">as</span> load_results:
</span></span><span style="display:flex;"><span>    load_results.save(pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>    loaded_program = load_results.getPrimary()
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> loaded_program:
</span></span><span style="display:flex;"><span>        program_path = <span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;/</span><span style="color:#cd5555">{</span>loaded_program.getName()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Program saved to: </span><span style="color:#cd5555">{</span>program_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span></code></pre></div><h3 id="4-获取程序并执行自动分析">4. 获取程序并执行自动分析</h3>
<p>从项目中获取程序对象,并执行 Ghidra 的自动分析:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22"># 从项目中获取程序</span>
</span></span><span style="display:flex;"><span>program, consumer = pyghidra.consume_program(project, program_path)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#228b22"># 检查是否需要分析</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">from</span> <span style="color:#008b45;text-decoration:underline">ghidra.program.util</span> <span style="color:#8b008b;font-weight:bold">import</span> GhidraProgramUtilities
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> GhidraProgramUtilities.shouldAskToAnalyze(program):
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;Analyzing program...&#34;</span>)
</span></span><span style="display:flex;"><span>        analysis_log = pyghidra.analyze(program, pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>        program.save(<span style="color:#cd5555">&#34;Analyzed&#34;</span>, pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;Analysis complete&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;Program already analyzed&#34;</span>)
</span></span></code></pre></div><h3 id="5-提取程序架构信息">5. 提取程序架构信息</h3>
<p>获取二进制文件的架构信息:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22"># 获取架构信息</span>
</span></span><span style="display:flex;"><span>lang = program.getLanguage()
</span></span><span style="display:flex;"><span>processor = lang.getProcessor().toString()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">Architecture: </span><span style="color:#cd5555">{</span>processor<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Language ID: </span><span style="color:#cd5555">{</span>lang.getLanguageID()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span></code></pre></div><h3 id="6-遍历函数">6. 遍历函数</h3>
<p>获取程序中的所有函数:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22"># 获取函数管理器</span>
</span></span><span style="display:flex;"><span>func_manager = program.getFunctionManager()
</span></span><span style="display:flex;"><span>functions = <span style="color:#658b00">list</span>(func_manager.getFunctions(<span style="color:#8b008b;font-weight:bold">True</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">Found </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(functions)<span style="color:#cd5555">}</span><span style="color:#cd5555"> functions&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 遍历函数</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">for</span> function <span style="color:#8b008b">in</span> functions:
</span></span><span style="display:flex;"><span>    func_name = function.getName()
</span></span><span style="display:flex;"><span>    entry_point = function.getEntryPoint()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">--- Function: </span><span style="color:#cd5555">{</span>func_name<span style="color:#cd5555">}</span><span style="color:#cd5555"> ---&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Entry point: </span><span style="color:#cd5555">{</span>entry_point<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Is thunk: </span><span style="color:#cd5555">{</span>function.isThunk()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span></code></pre></div><h3 id="7-分析基本块和控制流">7. 分析基本块和控制流</h3>
<p>这是示例代码的核心部分,展示如何提取函数的控制流图:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">from</span> <span style="color:#008b45;text-decoration:underline">ghidra.program.model.block</span> <span style="color:#8b008b;font-weight:bold">import</span> BasicBlockModel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 创建基本块模型</span>
</span></span><span style="display:flex;"><span>bb_model = BasicBlockModel(program)
</span></span><span style="display:flex;"><span>body = function.getBody()
</span></span><span style="display:flex;"><span>monitor = pyghidra.task_monitor()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 获取函数体内的所有基本块</span>
</span></span><span style="display:flex;"><span>blocks = <span style="color:#658b00">list</span>(bb_model.getCodeBlocksContaining(body, monitor))
</span></span><span style="display:flex;"><span><span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Basic blocks: </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(blocks)<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 遍历每个基本块</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">for</span> bb_idx, block <span style="color:#8b008b">in</span> <span style="color:#658b00">enumerate</span>(blocks[:<span style="color:#b452cd">5</span>]):  <span style="color:#228b22"># 只显示前5个块</span>
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">  Block </span><span style="color:#cd5555">{</span>bb_idx + <span style="color:#b452cd">1</span><span style="color:#cd5555">}</span><span style="color:#cd5555">:&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Start: </span><span style="color:#cd5555">{</span>block.getMinAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    End: </span><span style="color:#cd5555">{</span>block.getMaxAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span></code></pre></div><h3 id="8-提取指令">8. 提取指令</h3>
<p>遍历基本块中的指令:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22"># 获取程序列表(包含指令信息)</span>
</span></span><span style="display:flex;"><span>listing = program.getListing()
</span></span><span style="display:flex;"><span>addr = block.getMinAddress()
</span></span><span style="display:flex;"><span>ins_count = <span style="color:#b452cd">0</span>
</span></span><span style="display:flex;"><span>ins_list = []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 遍历基本块中的指令</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">while</span> addr <span style="color:#8b008b">and</span> addr &lt;= block.getMaxAddress():
</span></span><span style="display:flex;"><span>    ins = listing.getInstructionAt(addr)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> ins <span style="color:#8b008b">is</span> <span style="color:#8b008b;font-weight:bold">None</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#228b22"># 构建指令字符串</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> ins_count &lt; <span style="color:#b452cd">5</span>:  <span style="color:#228b22"># 只显示前5条指令</span>
</span></span><span style="display:flex;"><span>        op_rep = <span style="color:#cd5555">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">if</span> ins.getNumOperands() &gt; <span style="color:#b452cd">0</span>:
</span></span><span style="display:flex;"><span>            op_rep = ins.getDefaultOperandRepresentation(<span style="color:#b452cd">0</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">if</span> ins.getNumOperands() &gt; <span style="color:#b452cd">1</span>:
</span></span><span style="display:flex;"><span>                op_rep += <span style="color:#cd5555">&#34;, &#34;</span> + ins.getDefaultOperandRepresentation(<span style="color:#b452cd">1</span>)
</span></span><span style="display:flex;"><span>        ins_list.append(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">{</span>ins.getMnemonicString()<span style="color:#cd5555">}</span><span style="color:#cd5555"> </span><span style="color:#cd5555">{</span>op_rep<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ins_count += <span style="color:#b452cd">1</span>
</span></span><span style="display:flex;"><span>    addr = addr.add(ins.getLength())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Instructions (</span><span style="color:#cd5555">{</span>ins_count<span style="color:#cd5555">}</span><span style="color:#cd5555"> total):&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">for</span> ins_str <span style="color:#8b008b">in</span> ins_list:
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;      </span><span style="color:#cd5555">{</span>ins_str<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span></code></pre></div><h3 id="9-分析控制流边">9. 分析控制流边</h3>
<p>获取基本块的后继和前驱:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22"># 获取后继块(出边)</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>    destinations = block.getDestinations(monitor)
</span></span><span style="display:flex;"><span>    dest_list = []
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">while</span> destinations.hasNext():
</span></span><span style="display:flex;"><span>        dest = destinations.next()
</span></span><span style="display:flex;"><span>        dest_list.append(dest)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Successors: </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(dest_list)<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">for</span> dest <span style="color:#8b008b">in</span> dest_list[:<span style="color:#b452cd">3</span>]:
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;      -&gt; </span><span style="color:#cd5555">{</span>dest.getDestinationAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">except</span> <span style="color:#008b45;font-weight:bold">Exception</span> <span style="color:#8b008b;font-weight:bold">as</span> e:
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Successors: Error - </span><span style="color:#cd5555">{</span>e<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 获取前驱块(入边)</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>    sources = block.getSources(monitor)
</span></span><span style="display:flex;"><span>    src_list = []
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">while</span> sources.hasNext():
</span></span><span style="display:flex;"><span>        src = sources.next()
</span></span><span style="display:flex;"><span>        src_list.append(src)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#658b00">len</span>(src_list) &gt; <span style="color:#b452cd">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Sources: </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(src_list)<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">for</span> src <span style="color:#8b008b">in</span> src_list[:<span style="color:#b452cd">2</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;      &lt;- </span><span style="color:#cd5555">{</span>src.getSourceAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">except</span> <span style="color:#008b45;font-weight:bold">Exception</span> <span style="color:#8b008b;font-weight:bold">as</span> e:
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Sources: Error - </span><span style="color:#cd5555">{</span>e<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span></code></pre></div><p>完整代码：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#228b22">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#cd5555">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">Demo script to test pyghidra disassembly and observe the structure of results.
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">os</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">sys</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">pyghidra</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">from</span> <span style="color:#008b45;text-decoration:underline">pathlib</span> <span style="color:#8b008b;font-weight:bold">import</span> Path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># Add lib to path</span>
</span></span><span style="display:flex;"><span>sys.path.insert(<span style="color:#b452cd">0</span>, os.path.join(os.path.dirname(<span style="color:#00688b">__file__</span>), <span style="color:#cd5555">&#39;lib&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">def</span> <span style="color:#008b45">test_ghidra_disassembly</span>(binary_path, ghidra_path=<span style="color:#8b008b;font-weight:bold">None</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#cd5555">&#34;&#34;&#34;Test Ghidra disassembly on a single binary file&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Testing Ghidra disassembly on: </span><span style="color:#cd5555">{</span>binary_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#228b22"># Start pyghidra</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#8b008b">not</span> pyghidra.started():
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Starting pyghidra with install_dir=</span><span style="color:#cd5555">{</span>ghidra_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>        pyghidra.start(install_dir=ghidra_path)
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;pyghidra already started&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#228b22"># Create a temporary project</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">tempfile</span>
</span></span><span style="display:flex;"><span>    project_dir = tempfile.mkdtemp(prefix=<span style="color:#cd5555">&#39;ghidra_demo_&#39;</span>)
</span></span><span style="display:flex;"><span>    project_name = <span style="color:#cd5555">&#39;demo_project&#39;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Creating project at: </span><span style="color:#cd5555">{</span>project_dir<span style="color:#cd5555">}</span><span style="color:#cd5555">/</span><span style="color:#cd5555">{</span>project_name<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#228b22"># Open/create project</span>
</span></span><span style="display:flex;"><span>    project = pyghidra.open_project(project_dir, project_name, create=<span style="color:#8b008b;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#228b22"># Get program name</span>
</span></span><span style="display:flex;"><span>        program_name = os.path.basename(binary_path)
</span></span><span style="display:flex;"><span>        program_path = <span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;/</span><span style="color:#cd5555">{</span>program_name<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Importing binary: </span><span style="color:#cd5555">{</span>binary_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#228b22"># Import binary</span>
</span></span><span style="display:flex;"><span>        loader = pyghidra.program_loader()
</span></span><span style="display:flex;"><span>        loader = loader.project(project).source(binary_path).name(program_name)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">with</span> loader.load() <span style="color:#8b008b;font-weight:bold">as</span> load_results:
</span></span><span style="display:flex;"><span>            load_results.save(pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>            <span style="color:#228b22"># Get the program from load results</span>
</span></span><span style="display:flex;"><span>            loaded_program = load_results.getPrimary()
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">if</span> loaded_program:
</span></span><span style="display:flex;"><span>                program_path = <span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;/</span><span style="color:#cd5555">{</span>loaded_program.getName()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Program saved to: </span><span style="color:#cd5555">{</span>program_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#228b22"># Fallback: use the program name we specified</span>
</span></span><span style="display:flex;"><span>                program_path = <span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;/</span><span style="color:#cd5555">{</span>program_name<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Program saved to: </span><span style="color:#cd5555">{</span>program_path<span style="color:#cd5555">}</span><span style="color:#cd5555"> (using specified name)&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#228b22"># Get the program</span>
</span></span><span style="display:flex;"><span>        program, consumer = pyghidra.consume_program(project, program_path)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#228b22"># Analyze if needed</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">from</span> <span style="color:#008b45;text-decoration:underline">ghidra.program.util</span> <span style="color:#8b008b;font-weight:bold">import</span> GhidraProgramUtilities
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">if</span> GhidraProgramUtilities.shouldAskToAnalyze(program):
</span></span><span style="display:flex;"><span>                    <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;Analyzing program...&#34;</span>)
</span></span><span style="display:flex;"><span>                    analysis_log = pyghidra.analyze(program, pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>                    program.save(<span style="color:#cd5555">&#34;Analyzed&#34;</span>, pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>                    <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;Analysis complete&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;Program already analyzed&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">except</span> <span style="color:#008b45;font-weight:bold">Exception</span> <span style="color:#8b008b;font-weight:bold">as</span> e:
</span></span><span style="display:flex;"><span>                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Analysis check failed, attempting analysis: </span><span style="color:#cd5555">{</span>e<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                analysis_log = pyghidra.analyze(program, pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>                program.save(<span style="color:#cd5555">&#34;Analyzed&#34;</span>, pyghidra.task_monitor())
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#228b22"># Get architecture</span>
</span></span><span style="display:flex;"><span>            lang = program.getLanguage()
</span></span><span style="display:flex;"><span>            processor = lang.getProcessor().toString()
</span></span><span style="display:flex;"><span>            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">Architecture: </span><span style="color:#cd5555">{</span>processor<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Language ID: </span><span style="color:#cd5555">{</span>lang.getLanguageID()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#228b22"># Get function manager</span>
</span></span><span style="display:flex;"><span>            func_manager = program.getFunctionManager()
</span></span><span style="display:flex;"><span>            functions = <span style="color:#658b00">list</span>(func_manager.getFunctions(<span style="color:#8b008b;font-weight:bold">True</span>))
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">Found </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(functions)<span style="color:#cd5555">}</span><span style="color:#cd5555"> functions&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#228b22"># Examine first few functions</span>
</span></span><span style="display:flex;"><span>            func_count = <span style="color:#b452cd">0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">for</span> function <span style="color:#8b008b">in</span> functions:
</span></span><span style="display:flex;"><span>                func_count += <span style="color:#b452cd">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">if</span> func_count &gt; <span style="color:#b452cd">3</span>:  <span style="color:#228b22"># Only show first 3 functions</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                func_name = function.getName()
</span></span><span style="display:flex;"><span>                entry_point = function.getEntryPoint()
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">--- Function </span><span style="color:#cd5555">{</span>func_count<span style="color:#cd5555">}</span><span style="color:#cd5555">: </span><span style="color:#cd5555">{</span>func_name<span style="color:#cd5555">}</span><span style="color:#cd5555"> ---&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Entry point: </span><span style="color:#cd5555">{</span>entry_point<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Is thunk: </span><span style="color:#cd5555">{</span>function.isThunk()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#228b22"># Get basic blocks using BasicBlockModel</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">from</span> <span style="color:#008b45;text-decoration:underline">ghidra.program.model.block</span> <span style="color:#8b008b;font-weight:bold">import</span> BasicBlockModel
</span></span><span style="display:flex;"><span>                bb_model = BasicBlockModel(program)
</span></span><span style="display:flex;"><span>                body = function.getBody()
</span></span><span style="display:flex;"><span>                monitor = pyghidra.task_monitor()
</span></span><span style="display:flex;"><span>                blocks = <span style="color:#658b00">list</span>(bb_model.getCodeBlocksContaining(body, monitor))
</span></span><span style="display:flex;"><span>                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Basic blocks: </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(blocks)<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#228b22"># Examine multiple basic blocks (up to 5)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">for</span> bb_idx, block <span style="color:#8b008b">in</span> <span style="color:#658b00">enumerate</span>(blocks[:<span style="color:#b452cd">5</span>]):
</span></span><span style="display:flex;"><span>                    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">  Block </span><span style="color:#cd5555">{</span>bb_idx + <span style="color:#b452cd">1</span><span style="color:#cd5555">}</span><span style="color:#cd5555">:&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Start: </span><span style="color:#cd5555">{</span>block.getMinAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    End: </span><span style="color:#cd5555">{</span>block.getMaxAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                    <span style="color:#228b22"># Get instructions in this block</span>
</span></span><span style="display:flex;"><span>                    listing = program.getListing()
</span></span><span style="display:flex;"><span>                    addr = block.getMinAddress()
</span></span><span style="display:flex;"><span>                    ins_count = <span style="color:#b452cd">0</span>
</span></span><span style="display:flex;"><span>                    ins_list = []
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">while</span> addr <span style="color:#8b008b">and</span> addr &lt;= block.getMaxAddress():
</span></span><span style="display:flex;"><span>                        ins = listing.getInstructionAt(addr)
</span></span><span style="display:flex;"><span>                        <span style="color:#8b008b;font-weight:bold">if</span> ins <span style="color:#8b008b">is</span> <span style="color:#8b008b;font-weight:bold">None</span>:
</span></span><span style="display:flex;"><span>                            <span style="color:#8b008b;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#8b008b;font-weight:bold">if</span> ins_count &lt; <span style="color:#b452cd">5</span>:  <span style="color:#228b22"># Show first 5 instructions</span>
</span></span><span style="display:flex;"><span>                            op_rep = <span style="color:#cd5555">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#8b008b;font-weight:bold">if</span> ins.getNumOperands() &gt; <span style="color:#b452cd">0</span>:
</span></span><span style="display:flex;"><span>                                op_rep = ins.getDefaultOperandRepresentation(<span style="color:#b452cd">0</span>)
</span></span><span style="display:flex;"><span>                                <span style="color:#8b008b;font-weight:bold">if</span> ins.getNumOperands() &gt; <span style="color:#b452cd">1</span>:
</span></span><span style="display:flex;"><span>                                    op_rep += <span style="color:#cd5555">&#34;, &#34;</span> + ins.getDefaultOperandRepresentation(<span style="color:#b452cd">1</span>)
</span></span><span style="display:flex;"><span>                            ins_list.append(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">{</span>ins.getMnemonicString()<span style="color:#cd5555">}</span><span style="color:#cd5555"> </span><span style="color:#cd5555">{</span>op_rep<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                        ins_count += <span style="color:#b452cd">1</span>
</span></span><span style="display:flex;"><span>                        addr = addr.add(ins.getLength())
</span></span><span style="display:flex;"><span>                    <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Instructions (</span><span style="color:#cd5555">{</span>ins_count<span style="color:#cd5555">}</span><span style="color:#cd5555"> total):&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">for</span> ins_str <span style="color:#8b008b">in</span> ins_list:
</span></span><span style="display:flex;"><span>                        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;      </span><span style="color:#cd5555">{</span>ins_str<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                    <span style="color:#228b22"># Get successors</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>                        destinations = block.getDestinations(monitor)
</span></span><span style="display:flex;"><span>                        dest_list = []
</span></span><span style="display:flex;"><span>                        <span style="color:#8b008b;font-weight:bold">while</span> destinations.hasNext():
</span></span><span style="display:flex;"><span>                            dest = destinations.next()
</span></span><span style="display:flex;"><span>                            dest_list.append(dest)
</span></span><span style="display:flex;"><span>                        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Successors: </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(dest_list)<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                        <span style="color:#8b008b;font-weight:bold">for</span> dest <span style="color:#8b008b">in</span> dest_list[:<span style="color:#b452cd">3</span>]:  <span style="color:#228b22"># Show first 3 successors</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;      -&gt; </span><span style="color:#cd5555">{</span>dest.getDestinationAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">except</span> <span style="color:#008b45;font-weight:bold">Exception</span> <span style="color:#8b008b;font-weight:bold">as</span> e:
</span></span><span style="display:flex;"><span>                        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Successors: Error getting destinations - </span><span style="color:#cd5555">{</span>e<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                    <span style="color:#228b22"># Get sources (incoming edges)</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>                        sources = block.getSources(monitor)
</span></span><span style="display:flex;"><span>                        src_list = []
</span></span><span style="display:flex;"><span>                        <span style="color:#8b008b;font-weight:bold">while</span> sources.hasNext():
</span></span><span style="display:flex;"><span>                            src = sources.next()
</span></span><span style="display:flex;"><span>                            src_list.append(src)
</span></span><span style="display:flex;"><span>                        <span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#658b00">len</span>(src_list) &gt; <span style="color:#b452cd">0</span>:
</span></span><span style="display:flex;"><span>                            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Sources: </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(src_list)<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#8b008b;font-weight:bold">for</span> src <span style="color:#8b008b">in</span> src_list[:<span style="color:#b452cd">2</span>]:  <span style="color:#228b22"># Show first 2 sources</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;      &lt;- </span><span style="color:#cd5555">{</span>src.getSourceAddress()<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">except</span> <span style="color:#008b45;font-weight:bold">Exception</span> <span style="color:#8b008b;font-weight:bold">as</span> e:
</span></span><span style="display:flex;"><span>                        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;    Sources: Error getting sources - </span><span style="color:#cd5555">{</span>e<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">... and </span><span style="color:#cd5555">{</span><span style="color:#658b00">len</span>(functions) - func_count<span style="color:#cd5555">}</span><span style="color:#cd5555"> more functions&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">finally</span>:
</span></span><span style="display:flex;"><span>            program.release(consumer)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">finally</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>            project.close()
</span></span><span style="display:flex;"><span>            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">Project closed. Project directory: </span><span style="color:#cd5555">{</span>project_dir<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">except</span> <span style="color:#008b45;font-weight:bold">Exception</span> <span style="color:#8b008b;font-weight:bold">as</span> e:
</span></span><span style="display:flex;"><span>            <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;</span><span style="color:#cd5555">\n</span><span style="color:#cd5555">Error closing project: </span><span style="color:#cd5555">{</span>e<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#00688b">__name__</span> == <span style="color:#cd5555">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#658b00">len</span>(sys.argv) &lt; <span style="color:#b452cd">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">&#34;Usage: python test_ghidra_demo.py &lt;binary_path&gt; [ghidra_path]&#34;</span>)
</span></span><span style="display:flex;"><span>        sys.exit(<span style="color:#b452cd">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    binary_path = sys.argv[<span style="color:#b452cd">1</span>]
</span></span><span style="display:flex;"><span>    ghidra_path = sys.argv[<span style="color:#b452cd">2</span>] <span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#658b00">len</span>(sys.argv) &gt; <span style="color:#b452cd">2</span> <span style="color:#8b008b;font-weight:bold">else</span> os.environ.get(<span style="color:#cd5555">&#39;GHIDRA_INSTALL_DIR&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> <span style="color:#8b008b">not</span> os.path.exists(binary_path):
</span></span><span style="display:flex;"><span>        <span style="color:#658b00">print</span>(<span style="color:#cd5555">f</span><span style="color:#cd5555">&#34;Error: Binary file not found: </span><span style="color:#cd5555">{</span>binary_path<span style="color:#cd5555">}</span><span style="color:#cd5555">&#34;</span>)
</span></span><span style="display:flex;"><span>        sys.exit(<span style="color:#b452cd">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    test_ghidra_disassembly(binary_path, ghidra_path)
</span></span></code></pre></div>
                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">最后修改于 2025-12-30</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts">
			下回<br>已经到头啦。
                </a>
                
                
                
                <a class="older-posts">
			上回<br>这是最旧的文章了。
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="http://example.org/">
    
        <div class="nav-title">
            cvolcanob&#39; blog
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                博文
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                专栏
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                标签
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Copyright © 2025-2025 cvolcanob&#39;s Blog.
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85-ghidra-%e5%92%8c%e4%bd%bf%e7%94%a8%e5%85%b6-python-api" class="nav-安装-ghidra-和使用其-python-api">
									安装 Ghidra 和使用其 Python API
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85-ghidra" class="nav-安装-ghidra">
									安装 Ghidra
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85-pyghidra" class="nav-安装-pyghidra">
									安装 PyGhidra
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%ae%80%e5%8d%95%e7%9a%84-pyghidra-%e8%b0%83%e7%94%a8%e4%be%8b%e7%a8%8b" class="nav-简单的-pyghidra-调用例程">
									简单的 PyGhidra 调用例程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-%e5%88%9d%e5%a7%8b%e5%8c%96-pyghidra-%e7%8e%af%e5%a2%83" class="nav-1-初始化-pyghidra-环境">
									1. 初始化 PyGhidra 环境
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-%e5%88%9b%e5%bb%ba-ghidra-%e9%a1%b9%e7%9b%ae" class="nav-2-创建-ghidra-项目">
									2. 创建 Ghidra 项目
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-%e5%af%bc%e5%85%a5%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%96%87%e4%bb%b6" class="nav-3-导入二进制文件">
									3. 导入二进制文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#4-%e8%8e%b7%e5%8f%96%e7%a8%8b%e5%ba%8f%e5%b9%b6%e6%89%a7%e8%a1%8c%e8%87%aa%e5%8a%a8%e5%88%86%e6%9e%90" class="nav-4-获取程序并执行自动分析">
									4. 获取程序并执行自动分析
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#5-%e6%8f%90%e5%8f%96%e7%a8%8b%e5%ba%8f%e6%9e%b6%e6%9e%84%e4%bf%a1%e6%81%af" class="nav-5-提取程序架构信息">
									5. 提取程序架构信息
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#6-%e9%81%8d%e5%8e%86%e5%87%bd%e6%95%b0" class="nav-6-遍历函数">
									6. 遍历函数
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#7-%e5%88%86%e6%9e%90%e5%9f%ba%e6%9c%ac%e5%9d%97%e5%92%8c%e6%8e%a7%e5%88%b6%e6%b5%81" class="nav-7-分析基本块和控制流">
									7. 分析基本块和控制流
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#8-%e6%8f%90%e5%8f%96%e6%8c%87%e4%bb%a4" class="nav-8-提取指令">
									8. 提取指令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#9-%e5%88%86%e6%9e%90%e6%8e%a7%e5%88%b6%e6%b5%81%e8%be%b9" class="nav-9-分析控制流边">
									9. 分析控制流边
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>

<div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Copyright © 2025-2025 cvolcanob&#39;s Blog.
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
